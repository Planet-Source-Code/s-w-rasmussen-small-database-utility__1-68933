VERSION 5.00
Begin VB.Form Incomplete 
   BackColor       =   &H00EEE8E6&
   BorderStyle     =   1  'Fixed Single
   Caption         =   " Missing Information"
   ClientHeight    =   5355
   ClientLeft      =   45
   ClientTop       =   435
   ClientWidth     =   8835
   BeginProperty Font 
      Name            =   "Arial"
      Size            =   8.25
      Charset         =   0
      Weight          =   400
      Underline       =   0   'False
      Italic          =   0   'False
      Strikethrough   =   0   'False
   EndProperty
   Icon            =   "Incomplete.frx":0000
   LockControls    =   -1  'True
   MaxButton       =   0   'False
   MinButton       =   0   'False
   ScaleHeight     =   5355
   ScaleWidth      =   8835
   Begin VB.PictureBox Picture1 
      Appearance      =   0  'Flat
      AutoSize        =   -1  'True
      BackColor       =   &H80000005&
      ForeColor       =   &H80000008&
      Height          =   510
      Left            =   4920
      Picture         =   "Incomplete.frx":08CA
      ScaleHeight     =   480
      ScaleWidth      =   480
      TabIndex        =   37
      Top             =   3660
      Width           =   510
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "36"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   36
      Left            =   6330
      TabIndex        =   34
      Top             =   2820
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "35"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   35
      Left            =   6330
      TabIndex        =   33
      Top             =   2520
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "34"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   34
      Left            =   6330
      TabIndex        =   32
      Top             =   2220
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "33"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   33
      Left            =   6330
      TabIndex        =   31
      Top             =   1920
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "32"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   32
      Left            =   6330
      TabIndex        =   30
      Top             =   1620
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "31"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   31
      Left            =   6330
      TabIndex        =   29
      Top             =   1320
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "30"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   30
      Left            =   6330
      TabIndex        =   28
      Top             =   1020
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "29"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   29
      Left            =   6330
      TabIndex        =   27
      Top             =   720
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "28"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   28
      Left            =   6330
      TabIndex        =   26
      Top             =   420
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "37"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   37
      Left            =   6330
      TabIndex        =   25
      Top             =   3120
      Width           =   2160
   End
   Begin VB.CommandButton cmdAction 
      BackColor       =   &H00EEE8E6&
      Caption         =   "Clear + Refresh"
      Height          =   300
      Index           =   2
      Left            =   5670
      MaskColor       =   &H00EEE8E6&
      Style           =   1  'Graphical
      TabIndex        =   24
      Top             =   4920
      Width           =   1560
   End
   Begin VB.CommandButton cmdAction 
      BackColor       =   &H00EEE8E6&
      Caption         =   "Close"
      Height          =   300
      Index           =   1
      Left            =   4820
      MaskColor       =   &H00EEE8E6&
      Style           =   1  'Graphical
      TabIndex        =   23
      Top             =   4920
      Width           =   840
   End
   Begin VB.CommandButton cmdAction 
      BackColor       =   &H00EEE8E6&
      Caption         =   "Show Records"
      Height          =   300
      Index           =   0
      Left            =   7260
      MaskColor       =   &H00EEE8E6&
      Style           =   1  'Graphical
      TabIndex        =   22
      Top             =   4920
      Width           =   1440
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "17"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   17
      Left            =   3180
      TabIndex        =   16
      Top             =   2880
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "16"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   16
      Left            =   3180
      TabIndex        =   15
      Top             =   2580
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "15"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   15
      Left            =   3180
      TabIndex        =   14
      Top             =   2280
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "14"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   14
      Left            =   3180
      TabIndex        =   13
      Top             =   1980
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "13"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   13
      Left            =   3180
      TabIndex        =   12
      Top             =   1320
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "12"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   12
      Left            =   3180
      TabIndex        =   11
      Top             =   1020
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "11"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   11
      Left            =   3180
      TabIndex        =   10
      Top             =   720
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "10"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   10
      Left            =   3180
      TabIndex        =   9
      Top             =   420
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "09"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   9
      Left            =   180
      TabIndex        =   8
      Top             =   3180
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "08"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   8
      Left            =   180
      TabIndex        =   7
      Top             =   2880
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "07"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   7
      Left            =   180
      TabIndex        =   6
      Top             =   2580
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "01"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   1
      Left            =   180
      TabIndex        =   5
      Top             =   420
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "02"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   2
      Left            =   180
      TabIndex        =   4
      Top             =   720
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "03"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   3
      Left            =   180
      TabIndex        =   3
      Top             =   1020
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "04"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   4
      Left            =   180
      TabIndex        =   2
      Top             =   1680
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "05"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   5
      Left            =   180
      TabIndex        =   1
      Top             =   1980
      Width           =   2160
   End
   Begin VB.CheckBox chktxtList 
      Alignment       =   1  'Right Justify
      BackColor       =   &H00EEE8E6&
      Caption         =   "06"
      BeginProperty Font 
         Name            =   "Arial"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   220
      Index           =   6
      Left            =   180
      TabIndex        =   0
      Top             =   2280
      Width           =   2160
   End
   Begin VB.Label lblIncompleteCount 
      AutoSize        =   -1  'True
      BackColor       =   &H00EEE8E6&
      Caption         =   "Search result..."
      Height          =   210
      Left            =   180
      TabIndex        =   38
      Top             =   4995
      Width           =   1110
   End
   Begin VB.Line Line3 
      BorderColor     =   &H00FFC0C0&
      Index           =   1
      X1              =   8490
      X2              =   8700
      Y1              =   240
      Y2              =   240
   End
   Begin VB.Line Line1 
      BorderColor     =   &H00FFC0C0&
      Index           =   1
      X1              =   8700
      X2              =   8700
      Y1              =   240
      Y2              =   4780
   End
   Begin VB.Line Line4 
      BorderColor     =   &H00FFC0C0&
      X1              =   6060
      X2              =   8700
      Y1              =   4780
      Y2              =   4780
   End
   Begin VB.Line Line3 
      BorderColor     =   &H00FFC0C0&
      Index           =   0
      X1              =   6060
      X2              =   6285
      Y1              =   240
      Y2              =   240
   End
   Begin VB.Line Line2 
      BorderColor     =   &H00FFC0C0&
      X1              =   6060
      X2              =   8700
      Y1              =   3460
      Y2              =   3460
   End
   Begin VB.Label lblLegend 
      BackColor       =   &H00EEE8E6&
      BackStyle       =   0  'Transparent
      Height          =   1100
      Index           =   1
      Left            =   6160
      TabIndex        =   36
      Top             =   3600
      Width           =   2440
   End
   Begin VB.Line Line1 
      BorderColor     =   &H00FFC0C0&
      Index           =   0
      X1              =   6060
      X2              =   6060
      Y1              =   240
      Y2              =   4780
   End
   Begin VB.Label lblCaption 
      BackColor       =   &H000000C0&
      Caption         =   "7"
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      ForeColor       =   &H00FFFFFF&
      Height          =   225
      Index           =   7
      Left            =   6285
      TabIndex        =   35
      Top             =   120
      Width           =   2200
   End
   Begin VB.Label lblLegend 
      BackColor       =   &H00EEE8E6&
      Height          =   1000
      Index           =   0
      Left            =   180
      TabIndex        =   21
      Top             =   3660
      Width           =   4560
   End
   Begin VB.Label lblCaption 
      BackColor       =   &H00FDD6C6&
      Caption         =   "4"
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   225
      Index           =   4
      Left            =   3135
      TabIndex        =   20
      Top             =   1680
      Width           =   2200
   End
   Begin VB.Label lblCaption 
      BackColor       =   &H00FDD6C6&
      Caption         =   "3"
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   225
      Index           =   3
      Left            =   3135
      TabIndex        =   19
      Top             =   120
      Width           =   2200
   End
   Begin VB.Label lblCaption 
      BackColor       =   &H00FDD6C6&
      Caption         =   "2"
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   225
      Index           =   2
      Left            =   135
      TabIndex        =   18
      Top             =   1380
      Width           =   2200
   End
   Begin VB.Label lblCaption 
      BackColor       =   &H00FDD6C6&
      Caption         =   "1"
      BeginProperty Font 
         Name            =   "Tahoma"
         Size            =   8.25
         Charset         =   0
         Weight          =   700
         Underline       =   0   'False
         Italic          =   0   'False
         Strikethrough   =   0   'False
      EndProperty
      Height          =   225
      Index           =   1
      Left            =   135
      TabIndex        =   17
      Top             =   120
      Width           =   2200
   End
End
Attribute VB_Name = "Incomplete"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = False
Option Explicit

Private incmp()                 As Long
Private MeCaptionKeywords_M     As String
Private MeCaptionFields_M       As String

'------------------------------------------------------------------------------
' Create an array including records without text in the checked fields.
'------------------------------------------------------------------------------
Private Function Array_Create() As Boolean

On Error GoTo errhandler

Dim N                       As Long
Dim P                       As Long
Dim Q                       As Long
Dim rCount                  As Long
Dim fCount                  As Long
Dim numChecks               As Long
Dim numChecksR              As Long
Dim numKeywords             As Long
    
    ReDim incmp(1 To 1)
    
    ' get number of checked keywords
    numKeywords = 0
    MeCaptionKeywords_M = Space$(1)
    For N = 28 To 37
        If chktxtList(N).Value = 1 Then
            numKeywords = numKeywords + 1
            MeCaptionKeywords_M = MeCaptionKeywords_M & " - " & Main.lblField(N).Caption & Space$(1)
        End If
    Next N
    MeCaptionKeywords_M = Mid$(MeCaptionKeywords_M, 4)
    
    ' get number of checked text fields
    numChecks = 0
    MeCaptionFields_M = Space$(1)
    For N = 1 To 17
        If chktxtList(N).Value = 1 Then
            numChecks = numChecks + 1
            MeCaptionFields_M = MeCaptionFields_M & " - " & Main.lblField(N).Caption & Space$(1)
        End If
    Next N
    MeCaptionFields_M = Mid$(MeCaptionFields_M, 4)
    
    ' tell user if no checkmarks
    If numChecks = 0 Then
        MsgBox "No checkmarks,  Unable to analyse...     ", vbInformation + vbOKOnly, " WARNING"
        GoTo errhandler
    End If
    
    ' scan all records for empty fields and store record number in incmp() array
    fCount = 0
    For rCount = 1 To UBound(nr)
        
        If numKeywords > 0 Then
            ' see if keyword is checked - AND - the text field is empty
            numChecksR = 0
            For P = 1 To 17
                If chktxtList(P).Value = 1 And Len(Trim$(nr(rCount).txtField(P))) = 0 Then
                    For Q = 1 To 10
                        If chktxtList(Q + 27).Value + nr(rCount).chkKeyWord(Q) = 2 Then
                            numChecksR = numChecksR + 1
                        End If
                    Next Q
                End If
            Next P
            
        Else
            ' see if the checked text field is empty
            numChecksR = 0
            For P = 1 To 17
                If chktxtList(P).Value = 1 And Len(Trim$(nr(rCount).txtField(P))) = 0 Then
                    numChecksR = numChecksR + 1
                End If
            Next P
        End If
        
        ' store recordnumber only if number of empty checked
        ' fields is identital to total number of checkmarks
        If numChecksR = numChecks Then
            fCount = fCount + 1
            ReDim Preserve incmp(1 To fCount)
            incmp(fCount) = rCount
        End If
            
    Next rCount
    
    ' if a match is found then return with true - else false
    If fCount > 0 Then
        Array_Create = True
        lblIncompleteCount.Caption = "Your search criteria detected: " & fCount & " incomple records."
    Else
        Array_Create = False
        lblIncompleteCount.Caption = "Your search criteria detected: " & fCount & " incomple records."
    End If
    
    Exit Function
    
errhandler:
    Array_Create = False
    Exit Function
End Function

Private Sub Array_ListNewRecords()

On Error GoTo errhandler

Dim N                       As Long
Dim P                       As Long
Dim rowCount                As Long
Dim itmX                    As Object
    
    ' clear lvwmain
    RecordList.lvwMain.ColumnHeaders.Clear
    RecordList.lvwMain.ListItems.Clear
    RecordList.lvwMain.MultiSelect = True
    RecordList.lvwMain.SmallIcons = Main.ImageList1
    RecordList.lvwMain.Visible = False
    
    ' add column headers: main.lblfield().caption
    RecordList.lvwMain.ColumnHeaders.add , , "Nr", 700, lvwColumnLeft
    RecordList.lvwMain.ColumnHeaders.add , , "Record ID", 2000, lvwColumnLeft
    For N = 1 To 17
        If chktxtList(N).Value = 1 Then
            RecordList.lvwMain.ColumnHeaders.add , , "# " & Main.lblField(N).Caption, 1500, lvwColumnLeft
        Else
            RecordList.lvwMain.ColumnHeaders.add , , Main.lblField(N).Caption, 1500, lvwColumnLeft
        End If
    Next N
               
    ' set View property to Report.
    RecordList.lvwMain.View = lvwReport
    
    ' Display records in incmp array()
    For N = 1 To UBound(incmp)
        rowCount = 0
        Set itmX = RecordList.lvwMain.ListItems.add()
        itmX.SmallIcon = 3
        itmX.Text = Format$(incmp(N), "0000")
        rowCount = rowCount + 1
        itmX.SubItems(rowCount) = nr(incmp(N)).ID
        For P = 1 To 17
            rowCount = rowCount + 1
            itmX.SubItems(rowCount) = nr(incmp(N)).txtField(P)
        Next P
    Next N
    
' RED, records with missing information in selected text fields
    Call SetListViewLedger(RecordList.lvwMain, 1)   ' red, missing fields
    RecordList.StatusBar1.Panels.Item(3).Text = UBound(incmp) & " Records with missing information in selected fields."
    RecordList.Caption = " Missing Information For:" & MeCaptionKeywords_M & " / " & MeCaptionFields_M
    RecordList.FileItem(0).Visible = True           ' export to Excel
    RecordList.FileItem(1).Visible = True           ' sep
    RecordList.FileItem(2).Visible = False          ' add Records to project
    RecordList.FileItem(3).Visible = False          ' sep
    RecordList.FileItem(4).Visible = True           ' exit
    RecordList.lvwMain.Visible = True
    RecordList.Width = Screen.Width
    RecordList.Refresh
    RecordList.Show
    
    ' manages forms behaviour
    If MasterUser_G Then
        Main.Visible = True
        Record.Visible = False
    Else
        Main.Visible = False
        Record_ShowSingleR (CurrRecord_G)
        Record.Visible = True
    End If
        
errhandler:
    Exit Sub
End Sub






Private Sub LoadCaptions()

On Error GoTo errhandler

Dim N                       As Long
Dim msg1                    As String
Dim msg2                    As String
    
    ' load standard text fields
    For N = 1 To 17
        chktxtList(N).Caption = Main.lblField(N).Caption
    Next N
    
    ' load keywords
    For N = 28 To 37
        chktxtList(N).Caption = Main.lblField(N).Caption
    Next N
    
    ' load section captions
    For N = 1 To 4
        lblCaption(N).Caption = Main.lblCaption(N).Caption
    Next N
    lblCaption(7).Caption = Main.lblCaption(7).Caption
    
    msg1 = "Find missing information in records. Checkmark one or more fields to isolate records where these fields are empty." & vbCrLf & vbCrLf & _
           "Click 'Show Incomplete' to display a list of incomplete records. Double clicking a line in the list retrieves the selected record."
    
    msg2 = "Check one or more keyword to analyse a particular group of records. If none of the keywords are checked, all records are included in the analysis."
          
    lblLegend(0).Caption = msg1
    lblLegend(1).Caption = msg2
    
errhandler:
    Exit Sub
End Sub


Private Sub cmdAction_Click(Index As Integer)

On Error GoTo errhandler
    
Dim N                       As Long

    Select Case Index
        Case 0                          ' build record list
            FromIncomplete_G = True
            FromSearch_G = False
            
            If Array_Create Then
                Call Array_ListNewRecords
                Incomplete.Visible = False
            Else
                RecordList.Visible = False
                Incomplete.Visible = True
            End If
            
        Case 1                          ' close
            Unload Me
            
        Case 2                          ' clear and rebuild
            For N = 1 To 17
                chktxtList(N).Value = 0
            Next N
            
            For N = 28 To 37
                chktxtList(N).Value = 0
            Next N
            
            ' rebuild captions
            Call LoadCaptions
            
    End Select

errhandler:
    Exit Sub
End Sub


Private Sub Form_Load()

On Error GoTo errhandler
    
    Me.Left = (Screen.Width - Me.Width) / 2
    Me.Top = (Screen.Height - Me.Height) / 2
    
    FromIncomplete_G = True
    Call LoadCaptions
    
errhandler:
    Exit Sub
End Sub


Private Sub Form_Unload(Cancel As Integer)

On Error GoTo errhandler

    Unload RecordList
    Advanced.Visible = True
    
errhandler:
    Exit Sub
End Sub


